function containerCtrl(a){}function ftruckCtrl(a,b,c,d,e){function f(){var a="",b=[];!j.place||""==j.place&&void 0==j.place||(a=j.place.value),""!=a&&void 0!=a?(b=a.split(","),o={lat:b[0]?parseFloat(b[0]).toFixed(5):0,long:b[1]?parseFloat(b[1]).toFixed(5):0},h(o)):(k.createAlert(1,"Unable to find address",3),j.isSearchMap=!0,j.isSearch=!1,j.loading=!1)}function g(){var a="",b=[];j.isSearch=!0,!j.place||""==j.place&&void 0==j.place||(a=j.place.value),""!=a&&void 0!=a?(b=a.split(","),o={lat:b[0]?parseFloat(b[0]).toFixed(5):0,long:b[1]?parseFloat(b[1]).toFixed(5):0},h(o)):(k.createAlert(1,"Unable to find address",3),j.isSearchMap=!1,j.isSearch=!0,j.loading=!1)}function h(b){j.loading=!0,"0.00000"!=b.lat&&"0.00000"!=b.long?k.getTruckInfoByCord(b,function(c){if(c&&c.success){j.loading=!1,j.isSearch=!0,j.isSearchMap=!1;var d=c.response.data;if(d&&null!=d){j.truckPlaces=d;var e={zoom:15,center:new google.maps.LatLng(b.lat?b.lat:37.773972,b.long?b.long:-122.431297)};a.map=new google.maps.Map(document.getElementById("map"),e),google.maps.event.trigger(a.map,"resize");var f="../img/location-truck-1.png",g="../img/location-truck-2.png";j.markers=[];var h=new google.maps.InfoWindow({maxWidth:320,maxHeight:35}),m=function(c){var d=6371,e=i(parseFloat(c.latitude).toFixed(5)-b.lat),j=i(parseFloat(c.longitude).toFixed(5)-b.long),k=Math.sin(e/2)*Math.sin(e/2)+Math.cos(i(b.lat))*Math.cos(i(b.long))*Math.sin(j/2)*Math.sin(j/2),m=2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),n=parseFloat(d*m).toFixed(5);isNaN(n)?n="-":n+=" Km";var o=c.address?c.address:"Address Info not avaliable.",p=c.fooditems?c.fooditems:"Fooditem Info not avaliable.",q=c.applicant?c.applicant:"Applicant Info not avaliable.";p=p.split(":"),p=p.join();var r=new google.maps.Marker({map:a.map,icon:f,position:new google.maps.LatLng(c.latitude,c.longitude)});r.content='<div id="content"><div id="siteNotice"></div><p id="firstHeading" class="firstHeading"><b>'+q+"</b></p><p>("+o+')</p><div id="bodyContent"><p>'+p+"</p><p>"+n+"</p></div></div>",google.maps.event.addListener(r,"mouseover",function(){h.setContent(r.content),h.open(a.map,r),r.setIcon(g),l.playTruckTone()}),google.maps.event.addListener(r,"mouseout",function(){h.close(a.map,r),r.setIcon(f)}),google.maps.event.addListener(r,"click",function(){h.setContent(r.content),h.open(a.map,r),r.setIcon(g)})};angular.forEach(j.truckPlaces,function(a,b){m(j.truckPlaces[b])})}else k.createAlert(1,"No records founds",3),j.isSearch=!1,j.loading=!1}else k.createAlert(1,"Server error found",3),j.isSearch=!1,j.loading=!1}):1==j.isSearch?(j.isSearchMap=!1,j.loading=!1,k.createAlert(1,"No Truck avaliable in this route",3)):(j.isSearch=!1,j.isSearchMap=!0,j.loading=!1,k.createAlert(1,"No Truck avaliable in this route",3))}function i(a){return a*(Math.PI/180)}var j=this,k=d.WEBSERVICES,l=c.SOUNDNOTIFY,m=c.STORAGE;if(m.getStorage("access_token")){var n=!0;j.loading=!1,j.loading_place=!0,j.isSearch=!1,j.isSearchMap=!0,j.place="",j.place.value="",j.truckPlaces=[],j.places=[],j.selectedData=null,j.search=f,j.searchMap=g;var o={lat:"",long:""};k.getAllPlaces(n,function(a){j.loading=!1,j.loading_place=!1,j.isSearch=!1,j.isSearchMap=!0,a&&a.success&&a&&2e3===a.response.code?angular.forEach(a.response.data,function(a,b){j.places.push({label:a.address,value:a.latitude+","+a.longitude})}):j.loading=!1}),j.logout=function(){m.deleteStorage("access_token"),b.path("/login"),location.reload()}}else m.deleteStorage("access_token"),b.path("/login"),location.reload()}function loginCtrl(a,b,c,d,e){function f(){1==j.issignup?(j.signupbtn=!1,j.user.uName&&j.user.pwd&&j.user.email?k.signUp(j.user,function(a){a&&2e3===a.response.code?(j.issignup=!1,j.signupbtn=!0,j.loginbtn=!1,k.createAlert(2,"User Register Successfully",3),i(),b.path("/login")):k.createAlert(1,"User Already Exits",3)}):k.createAlert(1,"Please fill all mandatory details",3)):j.user.uName&&j.user.pwd?k.validatelogin(j.user,function(a){a&&2e3===a.response.code?(l.setStorage("access_token",a.response.data.token),b.path("/graph")):k.createAlert(1,"Invalid username and password",3)}):k.createAlert(1,"Please fill all mandatory details",3)}function g(){j.issignup=!0,j.signupbtn=!1,j.loginbtn=!0}function h(){j.issignup=!1,j.signupbtn=!0,j.loginbtn=!1}function i(){j.user={uName:"",pwd:"",email:""}}var j=this;j.issignup=!1,j.signupbtn=!0,j.loginbtn=!1,j.loading_1=!1;var k=d.WEBSERVICES,l=(c.SOUNDNOTIFY,c.STORAGE);j.user={uName:"",pwd:"",email:""},j.submit=f,j.signup=g,j.logAgn=h,l.getStorage("access_token")&&b.path("/graph")}var app=angular.module("done",["ngRoute","ui.bootstrap"]);app.config(["$httpProvider","$routeProvider",function(a,b){b.when("/",{redirectTo:"/login"}).when("/graph",{templateUrl:"templates/ftruck/ftruck.html",controller:"ftruckCtrl",controllerAs:"vmlogin"}).when("/login",{templateUrl:"templates/login/login.html",controller:"loginCtrl",controllerAs:"log"}).otherwise({redirectTo:"/login"})}]),app.controller("containerCtrl",["Utils",containerCtrl]),app.directive("hcPieChart",function(){return{restrict:"E",template:"<div></div>",scope:{title:"@",data:"="},link:function(a,b){Highcharts.chart(b[0],{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:""},tooltip:{pointFormat:"{series.name}:{point.y} <b>({point.percentage:.1f}%)</b>"},plotOptions:{pie:{cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.y}",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}}},series:[{name:a.title,colorByPoint:!0,data:a.data}]})}}}),app.directive("clientAutoComplete",function(){return{restrict:"A",link:function(a,b,c){c.autocomplete({source:function(b,c){var d=b.term,e=a.dataSource;if(e){var f=$filter("filter")(e,{name:d});angular.forEach(f,function(a){a.value=a.name})}c(f)},minLength:1,select:function(b,c){a.$apply(function(){a.setClientData(c.item)})}})}}}),app.directive("hcColumnChart",function(){return{restrict:"E",template:"<div></div>",scope:{title:"@",axistitle:"=",data:"="},link:function(a,b){Highcharts.chart(b[0],{chart:{type:"column"},title:{text:a.title},subtitle:{text:""},legend:{align:"right",verticalAlign:"middle",layout:"vertical"},xAxis:{categories:a.axistitle.xTitle,labels:{x:-10}},yAxis:{allowDecimals:!1,title:{text:a.axistitle.yTitle}},series:a.data,responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{align:"center",verticalAlign:"bottom",layout:"horizontal"},yAxis:{labels:{align:"left",x:0,y:-5},title:{text:null}},subtitle:{text:null},credits:{enabled:!1}}}]}})}}}),app.factory("Utils",function(){function a(a){return Base64.encode(a)}function b(a){return Base64.decode(a)}function c(){try{startTruckTone.pause(),startTruckTone.currentTime=0,startTruckTone.play()}catch(a){throw Error(a)}}function d(a,b){localStorage.setItem(a,b)}function e(a){var b=localStorage.getItem(a);return b||b}function f(a){localStorage.removeItem(a)}return{CONSTANTS:{BASE_URL:"http://10.40.13.71:3001/",SERVER_ERROR:"There is no internet connection or server unreachable.",SETTING:{SOUND_NOTIFY_SETTING_KEY:"SOUNDNOTIFY"}},STORAGE:{setStorage:d,getStorage:e,deleteStorage:f},SOUNDNOTIFY:{playTruckTone:c},ENCODE_DECODE:{encodeString:a,decodeString:b}}}),app.factory("WebService",["$http","Utils","$location",function(a,b,c){function d(a,d){401==a.code||402==a.code?(i(1,"your session has been expire please try to login again",3),b.STORAGE.deleteStorage("access-token"),c.path("/login")):(i(1,b.CONSTANTS.SERVER_ERROR,3),c.path("/login"),d(k))}function e(c,e){var f={username:c.uName,password:c.pwd},g={headers:{"Content-Type":"application/json",authorization:b.STORAGE.getStorage("access_token")}};a.post(j+"user/signin",f,g).success(function(a){k.success=!0,k.response=a,e(k)}).error(function(a){d(a)})}function f(c,e){var f={username:c.uName,password:c.pwd,email:c.email},g={headers:{"Content-Type":"application/json",authorization:b.STORAGE.getStorage("access_token")}};a.post(j+"user/signup",f,g).success(function(a){k.success=!0,k.response=a,e(k)}).error(function(a){d(a)})}function g(c,e){var f={headers:{"Content-Type":"application/json",authorization:b.STORAGE.getStorage("access_token")}};a.get(j+"v1/datasf/getAllData",f).success(function(a){k.success=!0,k.response=a,e(k)}).error(function(a){d(a)})}function h(c,e){var f="",g={headers:{"Content-Type":"application/json",authorization:b.STORAGE.getStorage("access_token")}};f=""!=c.lat&&""!=c.long?j+"v1/datasf/getCircleData/1000?lat="+c.lat+"&long="+c.long:j+"v1/datasf/getAllData",a.get(f,g).success(function(a){k.success=!0,k.response=a,e(k)}).error(function(a){d(a)})}function i(a,b,c){$("div.alert-box.active").remove(),c*=1e3;var d;switch(a){case 1:d=$("div.alert-box.alert-msg").clone();break;case 2:d=$("div.alert-box.success-msg").clone();break;case 3:d=$("div.alert-box.warning-msg").clone();break;default:d=$("div.alert-box.alert-msg").clone()}$(d).addClass("active"),$(d).find(".alert-message").text(b),$("#alert-container").append(d),$(d).slideDown(l),c&&setTimeout(function(){$(d).slideUp(l,function(){$(d).remove()})},c)}var j=b.CONSTANTS.BASE_URL,k={success:!1,response:null},l=750;return{WEBSERVICES:{validatelogin:e,getAllPlaces:g,getTruckInfoByCord:h,createAlert:i,signUp:f}}}]),app.filter("filterMultipleForOrder",["$filter",function(a){return function(a,b){function c(a,b){var c=[],d={searchText:!0,orderStatus:!0,multipleOrderStatus:!0,outlet:!0,subarea:!0,clientPlatform:!0,deliveryProvider:!0,dineinStatus:!0};return b&&b.length&&angular.forEach(b,function(b,e){a.orderStatus&&b.order_status&&b.order_status.status&&(d.orderStatus=b.order_status.status.toLowerCase()===a.orderStatus.toLowerCase()),a.multipleOrderStatus&&b.order_status&&b.order_status.status&&(d.multipleOrderStatus=a.multipleOrderStatus.toLowerCase().indexOf(b.order_status.status.toLowerCase())>-1),a.clientPlatform&&b.client_platform&&(d.clientPlatform=b.client_platform.toLowerCase().indexOf(a.clientPlatform.old_name.toLowerCase())>-1),a.outlet&&b.outlet&&b.outlet.name&&(d.outlet=b.outlet.name.toLowerCase().indexOf(a.outlet.name.toLowerCase())>-1),a.subarea&&b.user&&b.user.address&&(b.user.address.subarea_name?d.subarea=b.user.address.subarea_name.toLowerCase().indexOf(a.subarea.toLowerCase())>-1:b.user.address.area_name&&(d.subarea=b.user.address.area_name.toLowerCase().indexOf(a.subarea.toLowerCase())>-1)),a.deliveryProvider&&b.delivery_provider&&(d.deliveryProvider=b.delivery_provider.toLowerCase().indexOf(a.deliveryProvider.toLowerCase())>-1),a.dineinStatus&&b.reservation_status&&(d.dineinStatus=b.reservation_status.toLowerCase()===a.dineinStatus.toLowerCase()),a.searchText&&(d.searchText=JSON.stringify(b).toLowerCase().indexOf(a.searchText.toLowerCase())>-1),d.orderStatus&&d.outlet&&d.subarea&&d.clientPlatform&&d.searchText&&d.multipleOrderStatus&&d.deliveryProvider&&d.dineinStatus&&c.push(b)}),c}var d={data:a,filteredData:[],applyCustomFilter:c};return b&&(d.filteredData=d.applyCustomFilter(b,d.data)),d.filteredData}}]),app.filter("unique",function(){return function(a,b){if(!1===b)return a;if((b||angular.isUndefined(b))&&angular.isArray(a)){var c=[],d=function(a){return angular.isObject(a)&&angular.isString(b)?a[b]:a};angular.forEach(a,function(a){for(var b=!1,e=0;e<c.length;e++)if(angular.equals(d(c[e]),d(a))){b=!0;break}b||c.push(a)}),a=c}return a}}),app.filter("zpad",function(){return function(a,b){return void 0===a&&(a=""),a.length>=b?a:("0".repeat(b)+a).slice(-1*b)}}),app.filter("getTotal",function(){return function(a,b,c){var d=0;if(void 0!==a&&a.length>=1)for(var e=0;e<a.length;e++)d+=void 0!==c?a[e][b]*a[e][c]:a[e][b];return d}}),app.filter("timeSpanStringToDate",function(){return function(a,b){if(a){var c=new Date;b&&(c=Date.parse(b));return new Date(c.toLocaleDateString()+" "+a)}return a}}),app.controller("ftruckCtrl",["$scope","$location","Utils","WebService","$interval",ftruckCtrl]),app.controller("loginCtrl",["$scope","$location","Utils","WebService","$interval",loginCtrl]);